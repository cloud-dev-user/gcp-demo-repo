steps:
  - name: 'node:18'
    entrypoint: bash
    args:
      - -c
      - |
        npm install
        tar -czf node-app.tar.gz app.js package.json

  - name: 'curlimages/curl:latest'
    entrypoint: bash
    args:
      - -c
      - |
        curl -u "$ARTIFACTORY_USER:$ARTIFACTORY_PASS" \
          -T node-app.tar.gz \
          "https://your-artifactory.example.com/artifactory/libs-release-local/com/demo/node-app/1.0.0/node-app.tar.gz"

availableSecrets:
  secretManager:
    - versionName: projects/$PROJECT_ID/secrets/ARTIFACTORY_USER/versions/latest
      env: ARTIFACTORY_USER
    - versionName: projects/$PROJECT_ID/secrets/ARTIFACTORY_PASS/versions/latest
      env: ARTIFACTORY_PASS
